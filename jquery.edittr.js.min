/*
 * jquery.edittr
 * a jQuery plugin for making table rows editable
 * Copyright (c) SIX Safety Systems (http://www.sixsafetysystems.com)
 * Authored by Stephen Peasley (http://www.speasley.com)
 * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
 * and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.
 * 
 * Version 0.3.2
 * Made in Canada
 */
!function(e){"use strict";e.fn.edittr=function(){function t(e){0==a.silent&&console.log(e)}var a=e.extend({cancelText:"Cancel",editText:"Edit",saveText:"Save",silent:!1,onCancel:function(){},onEdit:function(){},onSave:function(){}},arguments[0]||{}),i=e(this);i.is("table")?i.addClass("edittr"):i.find("table").addClass("edittr");var n=e(document).find("table.edittr");0==n.length&&t("jquery.edittr will not work without a table");var l=n.find("td.editable").length>0;return 0==l&&t('jquery.edittr requires at least one td element to have a class of "editable"'),n.find("td.editable").each(function(){var i=e(this).parent().find("td.edit");1==i.length?i.html('<a aria-label="'+a.editText+'" class="edit"><span>'+a.editText+'</span></a><a aria-label="'+a.saveText+'" class="save"><span>'+a.saveText+'</span></a><a aria-label="'+a.cancelText+'" class="cancel"><span>'+a.cancelText+"</span></a>"):t('jquery.edittr requires each editable row to contain one td with a class of "edit"')}),e(".edittr a.edit").on("click",function(n){i.addClass("editing"),e(this).closest("tr").find("td.editable").each(function(){var a=e(this);a.data("original",e(this).text());var i=e(this).text();if(e(this).data("select")){e(this).html("<select>");var n=e(this).find("select"),l=e(this).data("select");"object"==!e.type(l)&&t('The "data-select" attribute must be a valid JavaScript object: {"key1":"value1","key2":"value2","key3":"value3"}'),e.each(l,function(e,t){e==i?n.append('<option value="'+t+'" selected="true">'+e+"</option>"):n.append('<option value="'+t+'">'+e+"</option>")})}else if(e(this).data("radio")){e(this).html("<fieldset>");var s=e(this).find("fieldset"),l=e(this).data("radio");"object"==!e.type(l)&&t('The "data-radio" attribute must be a valid JavaScript object: {"key1":"value1","key2":"value2","key3":"value3"}'),e.each(l,function(e,t){e==i?s.append('<input type="radio" value="'+t+'" id="'+t+'" checked="true"><label for="'+t+'">'+e+"</label>"):s.append('<input type="radio" value="'+t+'" id="'+t+'"><label for="'+t+'">'+e+"</label>")})}else if(e(this).data("checkbox")){e(this).html("<fieldset>");var s=e(this).find("fieldset"),l=e(this).data("checkbox");"object"==!e.type(l)&&t('The "data-checkbox" attribute must be a valid JavaScript object: {"key1":"value1","key2":"value2","key3":"value3"}'),e.each(l,function(e,t){e==i?s.append('<input type="checkbox" value="'+t+'" id="'+t+'" checked="true"><label for="'+t+'">'+e+"</label>"):s.append('<input type="checkbox" value="'+t+'" id="'+t+'"><label for="'+t+'">'+e+"</label>")})}else e(this).html('<input type="text" value="'+i+'">')});var l=e(this).closest("tr").find("td.edit");l.find("a.cancel").css({display:"inline-block"}),l.find("a.edit").css({display:"none"}),l.find("a.save").css({display:"inline-block"}),a.onEdit.call(this),n.preventDefault()}),e(".edittr a.cancel").on("click",function(t){i.removeClass("editing"),e(this).closest("tr").find("td.editable").each(function(){e(this).html(e(this).data("original"))});var n=e(this).closest("tr").find("td.edit");n.find("a.cancel").css({display:"none"}),n.find("a.edit").css({display:"inline-block"}),n.find("a.save").css({display:"none"}),a.onCancel.call(this),t.preventDefault()}),e(".edittr a.save").on("click",function(t){i.removeClass("editing"),e(this).closest("tr").find("td.editable").each(function(){var t=e(this).find('input[type="checkbox"]:checked').next().val()||e(this).find('input[type="radio"]:checked').next().val()||e(this).find("select option:selected").text()||e(this).find("input").val();e(this).html(t)});var n=e(this).closest("tr").find("td.edit");n.find("a.cancel").css({display:"none"}),n.find("a.edit").css({display:"inline-block"}),n.find("a.save").css({display:"none"}),a.onSave.call(this),t.preventDefault()}),e.edittr={revert:function(t){e(t).find("td.editable").each(function(){e(this).html(e(this).data("original"))})}},this}}(jQuery);